(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{127:function(e,t,a){e.exports=a.p+"static/media/help_center.70cd0aea.png"},129:function(e,t,a){e.exports=a.p+"static/media/qrcode.a8404a67.jpg"},130:function(e,t,a){e.exports=a(288)},197:function(e,t,a){},198:function(e,t,a){},282:function(e,t,a){},285:function(e,t,a){},286:function(e,t,a){},288:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(8),i=a.n(o),s=a(90),c=a(30),l=a(9),u=a(10),m=a(14),d=a(13),p=a(15),f=function(e,t){var a,n=t||"{y}-{m}-{d} {h}:{i}:{s}";"object"===typeof e?a=e:(10===(""+(e=e.replace(/-/g,"/"))).length&&(e=1e3*parseInt(e)),a=new Date(e));var r={y:a.getFullYear(),m:a.getMonth()+1,d:a.getDate(),h:a.getHours(),i:a.getMinutes(),s:a.getSeconds(),a:a.getDay()};return n.replace(/{(y|m|d|h|i|s|a)+}/g,function(e,t){var a=r[t];return"a"===t?["\u65e5","\u4e00","\u4e8c","\u4e09","\u56db","\u4e94","\u516d"][a]:(e.length>0&&a<10&&(a="0"+a),a||0)})},h=function(e,t){var a=new RegExp("(^|&)"+t+"=([^&]*)(&|$)","i");if(e.indexOf("?")>=0){var n=e.split("?")[1].match(a);return null!=n?n[2]:null}return null},g=function(e,t){return window.localStorage.setItem(e,t)},v=function(e){return window.localStorage.getItem(e)},w=function(e){return window.localStorage.removeItem(e)},b=function(){return!0},E=(a(43),a(17)),I=a.n(E),y=a(91),k=a.n(y);function S(){return{localhost:"https://symy.powerionics.cn"}[window.location.hostname]||"https://symy.powerionics.cn"}var x=[],C=k.a.CancelToken,_=function(e){for(var t in x)x[t].u==e.url+"&"+e.method&&(x[t].f(),x.splice(t,1))},N=k.a.create({baseURL:S(),params:{}});N.interceptors.request.use(function(e){return I.a.loading("",0),_(e),e.cancelToken=new C(function(t){x.push({u:e.url+"&"+e.method,f:t})}),e},function(e){Promise.reject(e)}),N.interceptors.response.use(function(e){var t=e.data;return I.a.hide(),_(e.config),0!=t.code?(I.a.info(JSON.stringify(t),1),Promise.reject(t)):e.data},function(e){return I.a.hide(),I.a.info(e.message,1),Promise.reject(e)});var A=N,j=function(e){return A({url:"/api/speech/info-mobile",method:"get",params:{mobile:e}})},U=function(e){return A({url:"/api/speech",method:"post",data:e})},O=function(e){return A({url:"/static/ueditor/1.4.3.3/php/controller.php?action=uploadvideo",method:"post",headers:{"Content-Type":"multipart/form-data"},data:e})},F=function(e){return A({url:"/static/ueditor/1.4.3.3/php/controller.php?action=uploadimage",method:"post",headers:{"Content-Type":"multipart/form-data"},data:e})},P=function(){return A({url:"/captcha/api",method:"get"})},L=function(){return A({url:"/api/back-image",method:"get"})},T=function(e){return A({url:"/api/wechat-jssdk-config",method:"get",params:{url:e}})},D=(a(197),a(198),function(e){function t(){var e;return Object(l.a)(this,t),(e=Object(m.a)(this,Object(d.a)(t).call(this))).state={},e}return Object(p.a)(t,e),Object(u.a)(t,[{key:"componentWillMount",value:function(){var e=this,t=h(window.location.search,"code"),a=h(window.location.search,"returnPath");if(!h(this.props.history.location.search,"bg"))if(b()){var n=v("_secret_wx_token");if(n)this.props.history.replace(a);else{if(!t)return void this.getAuth();(function(e){return A({url:"/api/wechat-token",method:"get",params:{code:e}})})(t).then(function(t){n=t.data,g("_secret_wx_token",n),setTimeout(function(){e.props.history.replace(a)},100)})}}else this.props.history.replace("/powerionics/write")}},{key:"getAuth",value:function(){var e=this.props.location.pathname,t=encodeURIComponent("https://symy.powerionics.cn/secret/?returnPath="+e),a="https://open.weixin.qq.com/connect/oauth2/authorize?appid=".concat("wx3edc25d22618f5e9","&redirect_uri=").concat(t,"&response_type=code&scope=snsapi_userinfo&state=STATE#wechat_redirect");window.location.replace(a)}},{key:"render",value:function(){return v("_secret_wx_token")?r.a.createElement("div",{id:"secret-wrap"},this.props.routes.map(function(e,t){return r.a.createElement(c.b,{key:t,exact:e.exact,path:e.path,render:function(t){return r.a.createElement(e.component,Object.assign({},t,{routes:e.routes}))}})})):null}}]),t}(r.a.Component)),R=(a(78),a(34)),V=a.n(R),M=a(61),W=a(40),B=a.n(W),q=(a(79),a(24)),H=a.n(q),J=(a(221),a(122)),z=a.n(J),K=(a(228),a(123)),$=a.n(K),G=(a(52),a(20)),Y=a.n(G),Q=(a(231),a(124)),X=a.n(Q),Z=a(29),ee=a(126),te=a.n(ee),ae=function(){function e(t,a){var n=this;Object(l.a)(this,e),this.config={bufferLen:4096,numChannels:2,mimeType:"audio/wav"},this.recording=!1,this.callbacks={getBuffer:[],exportWAV:[]},Object.assign(this.config,a),this.context=t.context,this.node=(this.context.createScriptProcessor||this.context.createJavaScriptNode).call(this.context,this.config.bufferLen,this.config.numChannels,this.config.numChannels),this.node.onaudioprocess=function(e){if(n.recording){for(var t=[],a=0;a<n.config.numChannels;a++)t.push(e.inputBuffer.getChannelData(a));n.worker.postMessage({command:"record",buffer:t})}},t.connect(this.node),this.node.connect(this.context.destination);this.worker=new te.a(function(){var e,t,a=0,n=[];function r(){for(var e=0;e<t;e++)n[e]=[]}function o(e,t){for(var a=new Float32Array(t),n=0,r=0;r<e.length;r++)a.set(e[r],n),n+=e[r].length;return a}function i(e,t,a){for(var n=0;n<a.length;n++)e.setUint8(t+n,a.charCodeAt(n))}this.onmessage=function(s){switch(s.data.command){case"init":c=s.data.config,e=c.sampleRate,t=c.numChannels,r();break;case"record":!function(e){for(var r=0;r<t;r++)n[r].push(e[r]);a+=e[0].length}(s.data.buffer);break;case"exportWAV":!function(r){for(var s,c=[],l=0;l<t;l++)c.push(o(n[l],a));s=2===t?function(e,t){var a=e.length+t.length,n=new Float32Array(a),r=0,o=0;for(;r<a;)n[r++]=e[o],n[r++]=t[o],o++;return n}(c[0],c[1]):c[0];var u=function(a){var n=new ArrayBuffer(44+2*a.length),r=new DataView(n);return i(r,0,"RIFF"),r.setUint32(4,36+2*a.length,!0),i(r,8,"WAVE"),i(r,12,"fmt "),r.setUint32(16,16,!0),r.setUint16(20,1,!0),r.setUint16(22,t,!0),r.setUint32(24,e,!0),r.setUint32(28,4*e,!0),r.setUint16(32,2*t,!0),r.setUint16(34,16,!0),i(r,36,"data"),r.setUint32(40,2*a.length,!0),function(e,t,a){for(var n=0;n<a.length;n++,t+=2){var r=Math.max(-1,Math.min(1,a[n]));e.setInt16(t,r<0?32768*r:32767*r,!0)}}(r,44,a),r}(s),m=new Blob([u],{type:r});this.postMessage({command:"exportWAV",data:m})}(s.data.type);break;case"getBuffer":!function(){for(var e=[],r=0;r<t;r++)e.push(o(n[r],a));this.postMessage({command:"getBuffer",data:e})}();break;case"clear":a=0,n=[],r()}var c}},{}),this.worker.postMessage({command:"init",config:{sampleRate:this.context.sampleRate,numChannels:this.config.numChannels}}),this.worker.onmessage=function(e){var t=n.callbacks[e.data.command].pop();"function"==typeof t&&t(e.data.data)}}return Object(u.a)(e,[{key:"record",value:function(){this.recording=!0}},{key:"stop",value:function(){this.recording=!1}},{key:"clear",value:function(){this.worker.postMessage({command:"clear"})}},{key:"getBuffer",value:function(e){if(!(e=e||this.config.callback))throw new Error("Callback not set");this.callbacks.getBuffer.push(e),this.worker.postMessage({command:"getBuffer"})}},{key:"exportWAV",value:function(e,t){if(t=t||this.config.mimeType,!(e=e||this.config.callback))throw new Error("Callback not set");this.callbacks.exportWAV.push(e),this.worker.postMessage({command:"exportWAV",type:t})}}],[{key:"forceDownload",value:function(e,t){var a=(window.URL||window.webkitURL).createObjectURL(e),n=window.document.createElement("a");n.href=a,n.download=t||"output.wav";var r=document.createEvent("Event");r.initEvent("click",!0,!0),n.dispatchEvent(r)}}]),e}(),ne=X.a.alert,re=window.wx,oe=function(e){function t(){var e;return Object(l.a)(this,t),(e=Object(m.a)(this,Object(d.a)(t).call(this))).comonRecord=function(){var t=e.state,a=t.audioStatus,n=t.recorder;clearTimeout(e.timer);var r=function(){var t=e.state,a=t.audioStatus,n=t.recorder;0==a||2==a?(e.setState({audioStatus:1,time:0,startAudio:!0}),n.record(),clearTimeout(e.timer),e.timer=setInterval(function(){e.setState({time:e.state.time+1},function(){e.state.time>=e.state.limitTime&&(clearInterval(e.timer),e.stopRecording())})},1e3)):1==a&&e.stopRecording()};if(e.state.time>=e.state.limitTime)ne("","\u60a8\u7684\u5f55\u97f3\u5df2\u7ecf\u8d85\u8fc7".concat(e.state.limitTime,"\u79d2\uff0c\u662f\u5426\u91cd\u65b0\u5f55\u5236\uff1f"),[{text:"\u5426",onPress:function(){}},{text:"\u662f",onPress:function(){e.setState({time:0},function(){n.clear(),e.record()})}}]);else if(0!=a||n)r();else{var o=null;try{window.AudioContext=window.AudioContext||window.webkitAudioContext,navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia,window.URL=window.URL||window.webkitURL,o=new AudioContext,navigator.mediaDevices.getUserMedia({audio:!0}).then(function(t){w("_secret_"),e.startUserMedia(o,t,r)}).catch(function(t){g("_secret_",JSON.stringify(e.props.form.getFieldsValue())),window.location.reload()})}catch(i){I.a.info("\u8be5\u6d4f\u89c8\u5668\u4e0d\u652f\u6301\u5f55\u97f3,\u8bf7\u7528\u5176\u4ed6\u6d4f\u89c8\u5668\u6216\u8005\u5fae\u4fe1\u6253\u5f00")}}},e.record=function(){b()?e.wxRecord():e.comonRecord()},e.onChange=function(t,a,n){if(0!=t.length){var r=t[0].file,o=new FormData;o.append("upfile",r),F(o).then(function(a){e.props.setImageFile(t,a)})}else e.props.setImageFile(t)},e.state={recorder:null,audioStatus:0,time:0,limitTime:30},e}return Object(p.a)(t,e),Object(u.a)(t,[{key:"componentWillMount",value:function(){clearTimeout(this.timer)}},{key:"componentWillUnmount",value:function(){clearTimeout(this.timer)}},{key:"startUserMedia",value:function(e,t,a){var n=e.createMediaStreamSource(t);this.setState({recorder:new ae(n)},function(){a&&a()})}},{key:"stopRecording",value:function(){var e=this,t=this.state.recorder;t.stop(),t.exportWAV(function(t){e.props.setAudioUrl(t),e.setState({audioStatus:0})}),t.clear()}},{key:"wxRecord",value:function(){var e=this,t=this.state,a=t.audioStatus;t.time,t.limitTime;clearTimeout(this.timer),0==a||2==a?re.startRecord({success:function(){e.setState({audioStatus:1,startAudio:!0,time:0}),clearTimeout(e.timer),e.timer=setInterval(function(){e.setState({time:e.state.time+1},function(){e.state.time>=e.state.limitTime&&(clearInterval(e.timer),re.stopRecord({success:function(t){e.setState({audioStatus:0}),e.props.setAudioUrl(t.localId,"wx")}}))})},1e3)}}):(clearTimeout(this.timer),re.stopRecord({success:function(t){e.setState({audioStatus:0}),e.props.setAudioUrl(t.localId,"wx")},fail:function(e){}}))}},{key:"render",value:function(){var e=this,t=this.state,a=t.audioStatus,n=(t.recorder,t.time),o=t.limitTime,i=this.props.form.getFieldProps,s=this.props.formData,c=s.say_to_you,l=s.files,u=void 0===l?[]:l,m=s.username,d=s.order_code,p=s.mobile,f=s.captcha_val,h=s.captcha_url,g=function(e){return e<10&&(e="0"+e),e};return r.a.createElement("form",{className:"my-form wirte-form"},r.a.createElement(Y.a,{className:"audio-list",renderHeader:function(){return r.a.createElement("div",{className:"audio-label-wrap"},r.a.createElement("p",{className:"label"},"\u6211\u60f3\u5bf9\u60a8\u8bf4\uff1a"),r.a.createElement("p",null,"\u53ef\u9009\u9879,\u5f55\u5236\u60a8\u60f3\u5bf9TA\u8bf4\u7684\u8bdd,\u9650",o,"\u79d2\u5185!"),1==a?r.a.createElement("p",{className:"tip"},"\u5f55\u97f3\u4e2d 00:",g(n)):e.state.startAudio?r.a.createElement("p",{className:"tip"},"\u5df2\u5f55\u97f3 00:",g(n)):null)}},r.a.createElement("div",{className:"audio-wrap"},r.a.createElement("p",{onClick:this.record,className:0==a?"btn start":"btn pause"}))),r.a.createElement(Y.a,{renderHeader:function(){return r.a.createElement("div",null,r.a.createElement("p",{className:"label require"},"\u5199\u7ed9TA\uff1a"),r.a.createElement("p",null,"\u586b\u5199\u60a8\u60f3\u5bf9TA\u8bf4\u7684\u8bdd,\u4e0d\u9650\u5b57\u6570!"))}},r.a.createElement($.a,Object.assign({rows:"4"},i("say_to_you",{initialValue:c,rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u5bf9TA\u8bf4\u7684\u8bdd"}]})))),r.a.createElement(Y.a,{className:"no-bg bg-list",renderHeader:function(){return r.a.createElement("div",null,r.a.createElement("p",{className:"label"},"\u6c38\u6052\u4e00\u523b\uff1a"),r.a.createElement("p",null,"\u9009\u586b\u9879\uff01\u4e0a\u4f20\u60a8\u60f3\u5206\u4eab\u7684\u56fe\u7247\uff0c\u53ef\u9009\u62e9\u4e0a\u4f20\u6216\u4e0d\u4e0a\u4f20\uff01"))}},r.a.createElement(z.a,{files:u,onChange:this.onChange,onImageClick:function(t,a){return e.props.previewImg(a[0].url)},selectable:u.length<1,multiple:!1})),r.a.createElement(Y.a,{renderHeader:function(){return r.a.createElement("div",null,r.a.createElement("p",{className:"label"},"\u9001\u5361\u4eba\u59d3\u540d/\u6635\u79f0\uff1a"),r.a.createElement("p",null,"\u9009\u586b\u9879\uff01\u5982\u679c\u60a8\u4e0d\u60f3\u8ba9\u5bf9\u65b9\u77e5\u9053\u662f\u8c01\uff0c\u53ef\u4e0d\u586b\uff01"))}},r.a.createElement(H.a,i("username",{initialValue:m}))),r.a.createElement(Y.a,{renderHeader:function(){return r.a.createElement("div",null,r.a.createElement("p",{className:"label require"},"powerionics\u6dd8\u5b9d\u6216\u4eac\u4e1c\u8ba2\u5355\u7f16\u53f7\uff1a"),r.a.createElement("p",null,"\u53ef\u5728\u60a8\u7684\u6dd8\u5b9d\u4eac\u4e1c\u8ba2\u5355\u5185\u67e5\u8be2\u590d\u5236\uff01"))}},r.a.createElement(H.a,i("order_code",{initialValue:d,rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u8ba2\u5355\u7f16\u53f7"}]}))),r.a.createElement(Y.a,{renderHeader:function(){return r.a.createElement("div",null,r.a.createElement("p",{className:"label require"},"\u624b\u673a\u53f7\u7801\uff1a"),r.a.createElement("p",{className:"danger"},"\u5fc5\u586b\u9879\uff01\u8bf7\u586b\u5199\u6536\u5361\u4eba\u7684\u624b\u673a\u53f7\uff0c\u6b64\u624b\u673a\u53f7\u5373\u4e3a\u5bf9\u65b9\u67e5\u8be2\u7559\u8a00\u7684\u552f\u4e00\u5bc6\u7801\uff0c\u8bf7\u6838\u5bf9\u65e0\u8bef\uff01"))}},r.a.createElement(H.a,Object.assign({type:"phone",placeholder:"\u5bf9\u65b9\u624b\u673a\u53f7\u7801"},i("mobile",{initialValue:p,rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u5bf9\u65b9\u624b\u673a\u53f7\u7801"}]})))),r.a.createElement(Y.a,{className:"no-bg",renderHeader:function(){return r.a.createElement("div",null,r.a.createElement("p",{className:"label require"},"\u9a8c\u8bc1\u7801\uff1a"),r.a.createElement("p",null,"\u586b\u5165\u53f3\u8fb9\u60a8\u770b\u5230\u7684\u5b57\u6bcd,\u533a\u5206\u5927\u5c0f\u5199!"))}},r.a.createElement("div",{className:"code-wrap"},r.a.createElement(H.a,Object.assign({placeholder:""},i("captcha_val",{initialValue:f,rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u9a8c\u8bc1\u7801"}]}))),r.a.createElement("div",{className:""},r.a.createElement("img",{className:"codeImg",onClick:this.props.getCodeUrl,src:h})))))}}]),t}(r.a.Component),ie=Object(Z.a)()(oe),se=window.wx,ce=function(e){function t(){var e;return Object(l.a)(this,t),(e=Object(m.a)(this,Object(d.a)(t).call(this))).playCommonAudio=function(){var t=document.getElementById("my_audio");t.volume=1;var a=e.state.audioPlayStatus;0==a?(t.play(),e.setState({audioPlayStatus:1})):1==a?(e.setState({audioPlayStatus:0}),t.pause()):2==a?(t.play(),e.setState({audioPlayStatus:1})):3==a&&(t.play(),e.setState({audioPlayStatus:1}))},e.playWxAudio=function(){var t=e.props.formData.wxAudioLocalId;0==e.state.audioPlayStatus?se.playVoice({localId:t,success:function(){e.setState({audioPlayStatus:1})}}):se.pauseVoice({localId:t,success:function(){e.setState({audioPlayStatus:0})}})},e.playAudio=function(){1==e.getAudioLinkStatus()?e.playWxAudio():(e.addAudioListenner(),e.playCommonAudio())},e.state={disabled:!0,files:[],imgFileId:null,recorder:null,audioPlayStatus:0,previewFlag:!1,previewImgArr:[],previewImgIndex:0,codeUrl:""},e}return Object(p.a)(t,e),Object(u.a)(t,[{key:"getAudioLinkStatus",value:function(){var e=this.props.formData,t=e.wx_audio_link,a=e.wxAudioLocalId;return t?2:a?1:0}},{key:"componentDidMount",value:function(){this.addAudioListenner()}},{key:"addAudioListenner",value:function(){var e=this,t=this.getAudioLinkStatus();if(1==t)se.onVoicePlayEnd({success:function(t){e.setState({audioPlayStatus:0})}});else if(2==t){var a=document.getElementById("my_audio");a&&a.addEventListener("ended",function(){e.setState({audioPlayStatus:0})},!1)}}},{key:"render",value:function(){var e=this,t=this.props.form.getFieldProps,a=this.state.audioPlayStatus,n=this.props.formData,o=n.say_to_you,i=n.files,s=void 0===i?[]:i,c=n.username,l=n.created_at,u=(n.audioUrl,n.wxAudioLocalId,n.wx_audio_link),m=s&&0!=s.length?s[0].url:"",d=this.getAudioLinkStatus();return r.a.createElement("form",{className:"my-form preview-form"},r.a.createElement(Y.a,{className:"audio-list",renderHeader:function(){return r.a.createElement("div",null,r.a.createElement("p",{className:"label"},"\u6211\u60f3\u5bf9\u60a8\u8bf4\uff1a"))}},r.a.createElement("div",null,r.a.createElement("p",{className:"word-wrap"},o),0!=d?r.a.createElement("div",{className:"audio-wrap"},r.a.createElement("p",{onClick:this.playAudio,className:1==a?"btn end":"btn start"}),2==d?r.a.createElement("audio",{id:"my_audio",src:S()+u}):null):null)),m?r.a.createElement(Y.a,{className:"no-bg bg-list",renderHeader:function(){return r.a.createElement("div",null,r.a.createElement("p",{className:"label"},"\u6c38\u6052\u4e00\u523b\uff1a"))}},r.a.createElement("div",{className:"preview-img"},r.a.createElement("img",{onClick:function(){return e.props.previewImg(m)},src:m}))):null,c?r.a.createElement(Y.a,{renderHeader:function(){return r.a.createElement("div",null,r.a.createElement("p",{className:"label"},"\u9001\u5361\u4eba\u59d3\u540d/\u6635\u79f0\uff1a"))}},r.a.createElement(H.a,t("username",{initialValue:c}))):null,r.a.createElement(Y.a,{renderHeader:function(){return r.a.createElement("div",null,r.a.createElement("p",{className:"label"},"\u53d1\u9001\u65f6\u95f4\uff1a"))}},r.a.createElement(H.a,t("created_at",{initialValue:l}))))}}]),t}(r.a.Component),le=Object(Z.a)()(ce),ue={},me=window.wx,de=function(e){function t(){var e;return Object(l.a)(this,t),(e=Object(m.a)(this,Object(d.a)(t).call(this))).getBgUrl=function(){L().then(function(t){var a=t.data;if(a&&0!=a.length){var n=S()+a[0].rel_image.path;e.setState({bgUrl:n})}})},e.previewImg=function(t){e.setState({previewFlag:!0,previewImgArr:[t],previewImgIndex:0})},e.previewClose=function(){e.setState({previewFlag:!1})},e.formSubmit=function(){var t=Object.assign({},e.state.formData),a=v("_secret_wx_token");a&&(t.wechat_token=a),e.state.imgFileId?t.thumb=e.state.imgFileId:t.thumb=0,t.mobile=t.mobile.replace(/\s*/g,""),t.captcha_key=e.state.codeKey,delete t.files,delete t.created_at,delete t.audioUrl,delete t.captcha_url;var n=function(t){ue.haveCommit=!0,e.setState({haveCommit:!0}),U(t).then(function(t){e.props.history.push("/success")}).catch(function(t){w("_secret_wx_token"),setTimeout(function(){e.props.history.replace("/powerionics/write")},100)})};if(b())e.state.wxAudioLocalId?me.uploadVoice({localId:e.state.wxAudioLocalId,isShowProgressTips:1,success:function(e){t.wx_audio=e.serverId,t.audio=0,n(t)}}):(t.audio=0,n(t));else if(e.state.audioBlod){var r=new FormData;r.append("upfile",e.state.audioBlod,"test.wav"),O(r).then(function(e){t.audio=e.id,n(t)})}else t.audio=0,n(t)},e.previewResult=function(){e.writeForm.props.form.validateFields({force:!0},function(t,a){if(t)for(var n in t){var r=t[n];return void I.a.info(r.errors[0].message,1)}else ue.formData=Object.assign({},e.state.formData,Object(M.a)({},e.writeForm.props.form.getFieldsValue(),{created_at:f(new Date),audioUrl:e.state.audioUrl,wxAudioLocalId:e.state.wxAudioLocalId})),e.setState({havePreview:!0,resultPreviewFlag:!0,formData:Object.assign({},e.state.formData,Object(M.a)({},e.writeForm.props.form.getFieldsValue(),{created_at:f(new Date),audioUrl:e.state.audioUrl,wxAudioLocalId:e.state.wxAudioLocalId}))})})},e.returnEdit=function(){ue.returnUpdate=!0,e.setState({returnUpdate:!0,resultPreviewFlag:!1})},e.getCodeUrl=function(){e.codeLock||(e.codeLock=!0,P().then(function(t){e.codeLock=!1,e.setState({formData:Object.assign({},e.state.formData,{captcha_url:t.img}),codeKey:t.key})}).catch(function(t){e.codeLock=!1}))},e.setImageFile=function(t,a){var n=null;a&&(n=a.id),e.setState({formData:Object.assign({},e.state.formData,{files:t}),imgFileId:n})},e.setAudioUrl=function(t,a){"wx"==a?e.setState({wxAudioLocalId:t}):t&&e.setState({audioBlod:t,audioUrl:URL.createObjectURL(t)})},e.state={imgFileId:null,previewFlag:!1,previewImgArr:[],previewImgIndex:0,bgUrl:"",formData:{},audioBlod:null,audioUrl:""},e}return Object(p.a)(t,e),Object(u.a)(t,[{key:"componentWillMount",value:function(){var e=h(this.props.history.location.search,"bg");e?this.setState({bgUrl:e}):this.getBgUrl(),this.getCodeUrl();var t={};ue.formData&&(t={havePreview:!0,resultPreviewFlag:!0,formData:ue.formData}),ue.returnUpdate&&(t.returnUpdate=!0),ue.haveCommit&&(t.haveCommit=!0),this.setState(Object(M.a)({},t))}},{key:"render",value:function(){var e=this,t=this.state,a=t.previewFlag,n=t.previewImgArr,o=t.previewImgIndex,i=t.bgUrl,s=t.resultPreviewFlag,c=t.formData,l=t.havePreview,u=t.returnUpdate,m=t.haveCommit;return r.a.createElement("div",{className:"write-wrap"},a?r.a.createElement(B.a,{onClose:this.previewClose,urls:n,index:o}):null,r.a.createElement("div",null,r.a.createElement("img",{className:"top-bg",src:i})),r.a.createElement("div",{className:"main"},s?r.a.createElement(le,{previewImg:this.previewImg,formData:c}):r.a.createElement(ie,{formData:c,previewImg:this.previewImg,setImageFile:this.setImageFile,getCodeUrl:this.getCodeUrl,setAudioUrl:this.setAudioUrl,previwe:!0,wrappedComponentRef:function(t){return e.writeForm=t}})),r.a.createElement("div",{className:"footer-record"},"\xa92009-2019 \u6df1\u5733\u5e02\u53f2\u6469\u65af\u8d38\u6613\u6709\u9650\u516c\u53f8 \u7248\u6743\u6240\u6709",r.a.createElement("br",null),"\u4e92\u8054\u7f51ICP\u5907\u6848\uff1a\u7ca4ICP\u590714040574\u53f7-1  "),r.a.createElement("div",{className:"fixed-bottom"},s?r.a.createElement("div",{className:"wrap"},r.a.createElement(V.a,{className:u?"visited":"",onClick:this.returnEdit},"\u8fd4\u56de\u4fee\u6539"),r.a.createElement(V.a,{className:m?"visited":"",onClick:this.formSubmit},"\u786e\u8ba4\u63d0\u4ea4")):r.a.createElement(V.a,{className:l?"visited":"",onClick:this.previewResult},"\u9884\u89c8")))}}]),t}(r.a.Component),pe=a(89),fe=a.n(pe),he=window.wx,ge=function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(m.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(r)))).state={check_status:"off",audioUrl:"",audioStatus:0,secretInfo:{},previewFlag:!1,previewImgArr:[],previewImgIndex:0,bgUrl:""},a.getBgUrl=function(){L().then(function(e){var t=e.data;if(t&&0!=t.length){var n=S()+t[0].rel_image.path;sessionStorage.setItem("check_top_bg",n),a.setState({bgUrl:n})}})},a.onSubmit=function(){a.props.form.validateFields({force:!0},function(e,t){if(e)for(var n in e){var r=e[n];return void I.a.info(r.errors[0].message)}else t.phone=t.phone.toString().replace(/\s*/g,""),a.getInfo(t.phone)})},a.previewImg=function(e){a.setState({previewFlag:!0,previewImgArr:[e],previewImgIndex:0})},a.previewClose=function(){a.setState({previewFlag:!1})},a.gotoHelpCenter=function(){a.props.history.push("/helpCenter")},a}return Object(p.a)(t,e),Object(u.a)(t,[{key:"componentWillMount",value:function(){}},{key:"getInfo",value:function(e){var t=this;j(e).then(function(e){var a=e.data;a.rel_audio&&(a.audioUrl=S()+a.rel_audio.path),a.rel_thumb&&(a.files=[{url:S()+a.rel_thumb.path}]),b()&&a.wx_audio?he.downloadVoice({serverId:a.wx_audio,isShowProgressTips:1,success:function(e){a.wxAudioLocalId=e.localId,ue.secretInfo=a,sessionStorage.setItem("secretInfo",JSON.stringify(a)),setTimeout(function(){t.props.history.push("/powerionics/checkDetail")},100)},fail:function(e){}}):(ue.secretInfo=a,sessionStorage.setItem("secretInfo",JSON.stringify(a)),setTimeout(function(){t.props.history.push("/powerionics/checkDetail")},100))})}},{key:"render",value:function(){var e=this.state,t=e.check_status,a=e.secretInfo,n=e.previewFlag,o=e.previewImgArr,i=e.previewImgIndex,s=e.bgUrl,c=this.props.form.getFieldProps;return r.a.createElement("div",{className:"secret-check-wrap"},n?r.a.createElement(B.a,{onClose:this.previewClose,urls:o,index:i}):null,"off"===t?r.a.createElement("div",{className:"secret-check-form-wrap"},r.a.createElement("div",{className:"top"},r.a.createElement("img",{src:fe.a})),r.a.createElement("div",{className:"main"},r.a.createElement("div",{className:"tip"},r.a.createElement("p",null,"\u60a8\u7684\u670b\u53cb\u968f\u793c\u7269\u8fd8\u7ed9\u60a8\u7559\u4e86\u4e00\u6bb5\u79c1\u8a00\u5bc6\u8bed\uff0c\u60a8\u7684\u624b\u673a\u53f7\u662f\u67e5\u8be2\u7559\u8a00\u7684\u5bc6\u7801\uff01"),r.a.createElement("p",null,"\u8bf7\u8f93\u5165\u60a8\u7684\u624b\u673a\u53f7\u7801\u67e5\u770bTA\u4e3a\u60a8\u7559\u4e0b\u7684\u79c1\u8a00\u5bc6\u8bed......")),r.a.createElement("form",{className:"secret-check-form"},r.a.createElement("div",{className:"label"},"\u8f93\u5165\u4f60\u7684\u624b\u673a\u53f7\u7801"),r.a.createElement(H.a,Object.assign({type:"phone"},c("phone",{initialValue:this.state.phone,rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u624b\u673a\u53f7\u7801"}]}))),r.a.createElement(V.a,{className:"search-btn",size:"small",onClick:this.onSubmit},"\u67e5\u770b")))):r.a.createElement("div",{className:"result"},r.a.createElement("div",{className:"top"},r.a.createElement("img",{src:s})),r.a.createElement(le,{previewImg:this.previewImg,formData:a}),r.a.createElement("div",{className:"fixed-bottom"},r.a.createElement("a",{className:"url-btn",href:"//powerionics.jd.com"},"\u6211\u4e5f\u8981\u6311\u9009\u793c\u7269\u9001TA"),r.a.createElement("span",{onClick:this.gotoHelpCenter,className:"help-center"},"\u5e2e\u52a9\u4e2d\u5fc3"))),r.a.createElement("div",{className:"footer-record"},"\xa92009-2019 \u6df1\u5733\u5e02\u53f2\u6469\u65af\u8d38\u6613\u6709\u9650\u516c\u53f8 \u7248\u6743\u6240\u6709",r.a.createElement("br",null),"\u4e92\u8054\u7f51ICP\u5907\u6848\uff1a\u7ca4ICP\u590714040574\u53f7-1  "))}}]),t}(r.a.Component),ve=Object(Z.a)()(ge),we=window.wx,be=function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(m.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(r)))).state={check_status:"off",audioUrl:"",audioStatus:0,secretInfo:null,previewFlag:!1,previewImgArr:[],previewImgIndex:0,bgUrl:""},a.getBgUrl=function(){L().then(function(e){var t=e.data;if(t&&0!=t.length){var n=S()+t[0].rel_image.path;sessionStorage.setItem("check_top_bg",n),a.setState({bgUrl:n})}})},a.onSubmit=function(){a.props.form.validateFields({force:!0},function(e,t){if(e)for(var n in e){var r=e[n];return void I.a.info(r.errors[0].message)}else t.phone=t.phone.toString().replace(/\s*/g,""),a.getInfo(t.phone)})},a.previewImg=function(e){a.setState({previewFlag:!0,previewImgArr:[e],previewImgIndex:0})},a.previewClose=function(){a.setState({previewFlag:!1})},a.gotoHelpCenter=function(){a.props.history.push("/helpCenter")},a}return Object(p.a)(t,e),Object(u.a)(t,[{key:"componentWillMount",value:function(){if(sessionStorage.getItem("check_top_bg")?this.setState({bgUrl:sessionStorage.getItem("check_top_bg")}):this.getBgUrl(),ue.secretInfo||sessionStorage.getItem("secretInfo")){var e=ue.secretInfo||JSON.parse(sessionStorage.getItem("secretInfo"));this.setState({check_status:"on",secretInfo:e})}else this.props.history.replace("/powerionics/check")}},{key:"getInfo",value:function(e){var t=this;j(e).then(function(e){var a=e.data;a.rel_audio&&(a.audioUrl=S()+a.rel_audio.path),a.rel_thumb&&(a.files=[{url:S()+a.rel_thumb.path}]),b()&&a.wx_audio?we.downloadVoice({serverId:a.wx_audio,isShowProgressTips:1,success:function(e){a.wxAudioLocalId=e.localId,sessionStorage.setItem("secretInfo",JSON.stringify(a)),t.setState({check_status:"on",secretInfo:a})},fail:function(e){}}):(sessionStorage.setItem("secretInfo",JSON.stringify(a)),t.setState({check_status:"on",secretInfo:a}))})}},{key:"render",value:function(){var e=this.state,t=(e.check_status,e.secretInfo),a=e.previewFlag,n=e.previewImgArr,o=e.previewImgIndex,i=e.bgUrl;this.props.form.getFieldProps;return r.a.createElement("div",{className:"secret-check-wrap result-wrap"},a?r.a.createElement(B.a,{onClose:this.previewClose,urls:n,index:o}):null,t?r.a.createElement("div",{className:"result"},r.a.createElement("div",{className:"top"},r.a.createElement("img",{src:i})),r.a.createElement(le,{previewImg:this.previewImg,formData:t}),r.a.createElement("div",{className:"fixed-bottom"},r.a.createElement("a",{className:"url-btn",href:"//powerionics.jd.com"},"\u6211\u4e5f\u8981\u6311\u9009\u793c\u7269\u9001TA"),r.a.createElement("span",{onClick:this.gotoHelpCenter,className:"help-center"},"\u5e2e\u52a9\u4e2d\u5fc3"))):null,r.a.createElement("div",{className:"footer-record"},"\xa92009-2019 \u6df1\u5733\u5e02\u53f2\u6469\u65af\u8d38\u6613\u6709\u9650\u516c\u53f8 \u7248\u6743\u6240\u6709",r.a.createElement("br",null),"\u4e92\u8054\u7f51ICP\u5907\u6848\uff1a\u7ca4ICP\u590714040574\u53f7-1  "))}}]),t}(r.a.Component),Ee=Object(Z.a)()(be),Ie=a(127),ye=a.n(Ie),ke=(a(282),function(e){function t(){return Object(l.a)(this,t),Object(m.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"helpCenter"},r.a.createElement("img",{src:ye.a}),r.a.createElement("div",{className:"footer-record"},"\xa92009-2019 \u6df1\u5733\u5e02\u53f2\u6469\u65af\u8d38\u6613\u6709\u9650\u516c\u53f8 \u7248\u6743\u6240\u6709",r.a.createElement("br",null),"\u4e92\u8054\u7f51ICP\u5907\u6848\uff1a\u7ca4ICP\u590714040574\u53f7-1  "))}}]),t}(r.a.Component)),Se=(a(283),a(128)),xe=a.n(Se),Ce=(a(64),a(57)),_e=a.n(Ce),Ne=a(129),Ae=a.n(Ne),je=(a(285),[{path:"/",redirect:"/powerionics/write",exact:!0},{path:"/helpCenter",component:ke},{path:"/success",component:function(e){function t(){return Object(l.a)(this,t),Object(m.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"success-wrap"},r.a.createElement(xe.a,{img:r.a.createElement(_e.a,{type:"check-circle",className:"spe",style:{fill:"#d2b78c"}}),title:"\u63d0\u4ea4\u6210\u529f",message:""}),r.a.createElement("div",{className:"warn-tip"},"\u4eb2\uff0c\u82e5\u60a8\u5fd8\u8bb0\u5728\u5929\u732b\u6216\u4eac\u4e1c\u8ba2\u5355\u5907\u6ce8\u201c\u79c1\u8a00\u5bc6\u8bed\u201d\uff0c\u8bf7\u52a1\u5fc5\u53ca\u65f6\u7528\u65fa\u65fa\u6216\u53ee\u549a\u8054\u7cfb\u5728\u7ebf\u5ba2\u670d\u5907\u6ce8\uff01"),r.a.createElement("div",{className:"qr-wrap"},r.a.createElement("p",{className:"tip"},"\u957f\u6309\u8bc6\u522b\u56fe\u70b9\u4e8c\u7ef4\u7801\u5173\u6ce8\u516c\u4f17\u53f7"),r.a.createElement("img",{className:"qr-code",src:Ae.a}),r.a.createElement("p",{className:"name"},"powerionics\u65d7\u8230\u5e97\uff0c\u66f4\u591a\u7cbe\u5f69\u6d3b\u52a8\u7b49\u7740\u60a8\uff01")),r.a.createElement("div",{className:"footer-record"},"\xa92009-2019 \u6df1\u5733\u5e02\u53f2\u6469\u65af\u8d38\u6613\u6709\u9650\u516c\u53f8 \u7248\u6743\u6240\u6709",r.a.createElement("br",null),"\u4e92\u8054\u7f51ICP\u5907\u6848\uff1a\u7ca4ICP\u590714040574\u53f7-1  "))}}]),t}(r.a.Component)},{path:"/powerionics",component:D,routes:[{path:"/powerionics/write",component:de},{path:"/powerionics/check",component:ve},{path:"/powerionics/checkDetail",component:Ee}]}]),Ue=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function Oe(e,t){navigator.serviceWorker.register(e).then(function(e){e.onupdatefound=function(){var a=e.installing;null!=a&&(a.onstatechange=function(){"installed"===a.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}}).catch(function(e){console.error("Error during service worker registration:",e)})}a(286),a(287);!function(e){var t=window.location.href.split("#")[0];T(t).then(function(e){var t=e.data,a=t.appId,n=t.timestamp,r=t.nonceStr,o=t.signature;window.wx.config({debug:!1,appId:a,timestamp:n,nonceStr:r,signature:o,jsApiList:["translateVoice","startRecord","stopRecord","onVoiceRecordEnd","playVoice","pauseVoice","stopVoice","onVoicePlayEnd","uploadVoice","downloadVoice"]})})}(),i.a.render(r.a.createElement(s.a,null,je.map(function(e,t){return r.a.createElement(c.b,{key:t,exact:e.exact,path:e.path,render:function(t){return e.redirect?r.a.createElement(c.a,{to:e.redirect}):r.a.createElement(e.component,Object.assign({},t,{routes:e.routes}))}})})),document.querySelector("#root")),function(e){if("serviceWorker"in navigator){if(new URL(".",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",function(){var t="".concat(".","/service-worker.js");Ue?(function(e,t){fetch(e).then(function(a){var n=a.headers.get("content-type");404===a.status||null!=n&&-1===n.indexOf("javascript")?navigator.serviceWorker.ready.then(function(e){e.unregister().then(function(){window.location.reload()})}):Oe(e,t)}).catch(function(){console.log("No internet connection found. App is running in offline mode.")})}(t,e),navigator.serviceWorker.ready.then(function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")})):Oe(t,e)})}}()},89:function(e,t,a){e.exports=a.p+"static/media/check_top_bg.46ff4ce0.jpg"}},[[130,1,2]]]);
//# sourceMappingURL=main.d5179b83.chunk.js.map